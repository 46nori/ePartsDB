# ePartsDB - 電子パーツ在庫管理システム

電子パーツの在庫を効率的に管理するためのWebアプリケーションです。

このプログラムは、GitHub CopilotのAgentモードで生成されました。使用したモデルはClaude Sonnet 4 (Preview)です。

## 🚀 機能

### ✅ 基本機能
- **パーツ検索**: カテゴリ別検索とキーワード検索
- **在庫管理**: パーツの在庫数表示・編集
- **詳細情報**: パーツの詳細情報表示
- **パーツ編集**: パーツ情報の編集
- **パーツ追加**: 新規パーツの追加
- **パーツ削除**: 不要なパーツの削除
- **データ同期**: データベースファイルのダウンロード
- **レスポンシブUI**: スマートフォン・タブレット対応

### 🔧 運用モード

このシステムには2つの運用モードがあります：

- **リモートモード** (GitHub Pages等): 読み取り専用、データ閲覧用
- **ローカルモード**: 編集・追加・削除が可能、データ管理用

ローカルモードはデータベースの編集・管理を行うための本格的な運用モードです。

### 🌟 高度な機能
- **ブラウザ内SQLite**: sql.jsによるクライアントサイドデータベース
- **環境自動判別**: デプロイ環境を自動判別してUI切り替え
- **ブラウザ別ダウンロード対応**: Chrome/Safari/Firefox対応
- **ダウンロード場所ガイド**: ブラウザ・OS別の保存場所案内

## 🛠 技術スタック

- **フロントエンド**: React 18 + TypeScript + Vite
- **データベース**: SQLite + sql.js (ブラウザ内実行)
- **スタイリング**: Tailwind CSS
- **アイコン**: Lucide React
- **ホスティング**: GitHub Pages (静的)
- **ビルドツール**: Vite
- **型チェック**: TypeScript

## 📊 プロジェクト統計

- **総コード行数**: 2,230行
- **コンポーネント数**: 6個
- **主要機能**: 検索・編集・追加・削除・同期
- **対応ブラウザ**: Chrome, Safari, Firefox, Edge

## 📦 セットアップ

### 依存関係のインストール

```bash
npm install
```

## 🚀 運用方法

### 🌐 リモートモード（データ閲覧用）

GitHub Pagesで公開されているアプリで、データの閲覧のみ可能です。

**アクセス方法:**
- GitHub Pagesのデプロイ済みURLにアクセス

**特徴:**
- 読み取り専用
- パーツ検索・詳細表示のみ
- 最新のデータベース内容を反映

### 💻 ローカルモード（データ管理用）

ローカルサーバーで動作するモードで、データベースの編集・管理が可能です。

**起動方法:**
```bash
npm run dev
```

**アクセス:**
- ブラウザで `http://localhost:5173` を開く

**特徴:**
- 編集・追加・削除が可能
- リアルタイムでデータ変更
- データベースファイルのダウンロード機能

**データ更新フロー:**
1. ローカルモードでデータを編集
2. 「同期（ダウンロード）」ボタンで更新されたeparts.dbをダウンロード
3. ダウンロードしたeparts.dbをリポジトリのルート配下の`database/`に配置
4. Gitでコミット・プッシュ
5. 次回のGitHub Pagesデプロイ時にリモートモードへ反映

## 🚢 デプロイ

### ブランチ構成と運用方式

このプロジェクトは以下のブランチ構成で運用されます：

- **`main`ブランチ**:
  - プログラムのソースコード
  - サンプルデータベース（`database/eparts.db`）
  - **リリース用・配布用**
  - 開発者向けの基本セット

- **`gh-pages`ブランチ**:
  - **ユーザー個別の運用ブランチ**
  - `main`からクローン後に作成
  - 個人用データベース（`database/eparts.db`）を継続更新
  - GitHub Pagesでホスティング
  - 実際の在庫管理に使用

### 🔄 初期セットアップ（ユーザー向け）

**このシステムを個人利用する場合の手順:**

1. **リポジトリをフォーク/クローン**

   ```bash
   git clone <your-repository-url>
   cd ePartsDB
   ```

2. **gh-pagesブランチを作成・切り替え**

   ```bash
   git checkout -b gh-pages
   git push -u origin gh-pages
   ```

3. **GitHub Pagesの設定**
   - GitHubリポジトリの「Settings」→「Pages」
   - Source: "Deploy from a branch"
   - Branch: `gh-pages` / `/ (root)`

4. **初回ビルド・デプロイ**

   ```bash
   npm install
   npm run build
   git add dist/
   git commit -m "初期デプロイ"
   git push origin gh-pages
   ```

### 📊 継続運用（データベース更新）

**日常的な在庫管理での手順:**

1. ローカルで開発サーバー起動

   ```bash
   git checkout gh-pages  # 個人運用ブランチに切り替え
   npm run dev
   ```

2. ブラウザでデータ編集・在庫更新

3. 「同期（ダウンロード）」でデータベースファイルを取得

4. データベースファイルを更新・デプロイ

   ```bash
   # ダウンロードしたファイルをdatabase/に配置
   cp ~/Downloads/eparts.db database/eparts.db
   
   # データベースファイルをコミット・プッシュ
   git add database/eparts.db
   git commit -m "在庫データ更新: [変更内容]"
   git push origin gh-pages
   ```

**重要**: 個人の在庫データは`gh-pages`ブランチで管理し、`main`ブランチには反映させません。

### GitHub Pagesへのデプロイ

#### 🔧 GitHub Pagesの設定

1. **リポジトリの設定**
   - GitHubリポジトリの「Settings」タブに移動
   - 左サイドバーの「Pages」をクリック

2. **ソースの設定（ブランチベース）**
   - **Source**: 「Deploy from a branch」を選択
   - **Branch**: `gh-pages` を選択
   - **Folder**: `/ (root)` を選択
   - 「Save」をクリック

3. **デプロイ方式**

   現在の運用では、手動でのビルド・デプロイを行います：

   ```bash
   # ローカルでビルド
   npm run build
   
   # 静的ファイルをコミット
   git add dist/
   git commit -m "サイト更新"
   git push origin gh-pages
   ```

   **注意**: GitHub Actionsによる自動デプロイは現在無効化されています。

4. **ビルドが必要な場合**

   アプリケーションコード（JavaScript/TypeScript）を変更した場合のみ：

   ```bash
   npm run build
   git add dist/
   git commit -m "アプリケーション更新"
   git push origin gh-pages
   ```

   **データベースファイルのみ更新の場合はビルド不要です。**

#### 📋 デプロイ後の確認

- GitHub Pagesの設定画面でデプロイ状況を確認
- 「Actions」タブでビルド・デプロイの実行状況を確認
- 公開URLでアプリケーションにアクセス

#### 🔄 データベース更新の反映

1. ローカルモードでデータを編集
2. 「同期（ダウンロード）」でeparts.dbをダウンロード
3. ダウンロードしたファイルをリポジトリルートに配置
4. Git commit & push
5. GitHub Actionsが自動実行され、更新されたデータがリモートモードに反映

## 🗄 データベース

データベースは`database/eparts.db`に配置されています。

### スキーマ

- `categories`: パーツカテゴリ
- `parts`: 電子パーツ基本情報  
- `inventory`: 在庫情報

詳細なスキーマ定義は `URS/schema.sql` を参照してください。

## 📱 使用方法

### パーツ検索（全モード共通）

1. **カテゴリ検索**: カテゴリボタンをクリック
2. **キーワード検索**: 検索ボックスにキーワードを入力
3. **詳細表示**: パーツ行の情報アイコンをクリック

### データ管理（ローカルモードのみ）

#### 在庫編集

1. 在庫数の数値を直接編集
2. 「同期（ダウンロード）」ボタンでデータベースファイルをダウンロード

#### パーツ編集

1. パーツ行の編集ボタンをクリック
2. 情報を編集して保存

#### パーツ追加

1. 「パーツの追加」ボタンをクリック
2. 必要な情報を入力して保存

#### パーツ削除

1. パーツ行の削除ボタンをクリック
2. 確認ダイアログで削除を実行

### データベース更新フロー（個人運用）

**個人の`gh-pages`ブランチでの在庫管理:**

1. ローカルモードでデータを編集（在庫数・パーツ情報など）
2. 「同期（ダウンロード）」ボタンをクリック
3. ファイル保存ダイアログで保存場所を選択（デフォルト：ダウンロードフォルダ）
4. ダウンロードした`eparts.db`ファイルを`database/`フォルダに移動
5. **`gh-pages`ブランチにコミット・プッシュ**

   ```bash
   git checkout gh-pages
   git add database/eparts.db
   git commit -m "在庫データ更新: [変更内容の説明]"
   git push origin gh-pages
   ```

   **注意**: データベースファイルの更新のみの場合、`npm run build`は不要です。

6. GitHub Pagesで個人サイトに自動反映

**保存場所のヒント:**

- Chrome/Edge: ファイル保存ダイアログでプロジェクトフォルダの`database/`に直接保存可能
- Safari/Firefox: ダウンロードフォルダに保存後、手動でプロジェクトの`database/`フォルダに移動

## 🚧 開発状況

### ✅ 実装済み機能

- ✅ パーツ検索（カテゴリ・キーワード）
- ✅ パーツ詳細表示
- ✅ 在庫数編集
- ✅ パーツ情報編集
- ✅ パーツ新規追加
- ✅ パーツ削除
- ✅ データベース同期（ダウンロード）
- ✅ 環境自動判別
- ✅ レスポンシブUI
- ✅ ブラウザ別ダウンロード対応

### 🎯 品質指標

- ✅ TypeScript型安全性
- ✅ エラーハンドリング
- ✅ ユーザビリティ
- ✅ パフォーマンス最適化
- ✅ セキュリティ対策

## 🔧 開発者・管理者向け情報

### ブランチの役割分担

**開発者・管理者の場合:**

- `main`ブランチで機能開発・バグ修正
- サンプルデータベースの更新・メンテナンス
- リリース版の配布・管理

**エンドユーザーの場合:**

- `main`からフォーク・クローン
- `gh-pages`ブランチで個人の在庫管理
- 個人データは`main`に反映させない

## 🔧 アプリケーション開発

このセクションはアプリケーション自体の開発に関する情報です。

### 開発要件

- Node.js 18+
- npm または yarn

### 開発環境セットアップ

```bash
git clone <repository-url>
cd ePartsDB
npm install
npm run dev
```

### ビルド構成

**開発用ビルド:**

```bash
npm run dev  # 開発サーバー起動（ローカルモード）
```

**本番用ビルド:**

```bash
npm run build      # 本番ビルド
npm run preview    # ビルド結果をプレビュー
```

**出力:**

- `dist/` フォルダに静的ファイルが生成される
- GitHub Pagesや任意の静的サーバーにデプロイ可能

## 📄 ライセンス

このプロジェクトは MIT License の下でライセンスされています。

詳細については [LICENSE](LICENSE) ファイルを参照してください。
