# Changelog

このファイルは、ePartsDBプロジェクトの重要な変更をすべて記録します。

フォーマットは [Keep a Changelog](https://keepachangelog.com/ja/1.0.0/) に基づいており、
このプロジェクトは [Semantic Versioning](https://semver.org/lang/ja/) に準拠しています。

## [2.1.0] - 2025-08-06

### ✨ 新機能

- **パーツ詳細モーダルのキーボードサポート** (Issue #8)
  - ESCキーでモーダルを閉じる機能を追加
  - Enterキーでモーダルを閉じる機能を追加（フォーカス可能な要素がない場合）
  - モーダル開閉時の適切なフォーカス管理を実装
  - ユーザビリティとアクセシビリティの向上

### 🐛 修正

- **検索結果表示の不具合修正** (Issue #6)
  - キーワード未指定の全検索時に在庫数変更が反映されない問題を修正
  - refreshSearchResults関数の条件文を改善
  - 在庫数変更後の画面更新が正しく動作するよう修正

- **フォーム入力値の表示問題修正** (Issue #7)
  - パーツ追加・編集ダイアログで在庫数0が表示されない問題を修正
  - number型フィールドの初期値処理を`|| ''`から`?? ''`に変更
  - 値が0の場合に正しく表示されるよう改善

### 🔧 技術的改良

- **フォーカス管理の改善**
  - モーダル要素への適切なフォーカス設定
  - キーボードナビゲーション対応の強化
  - アクセシビリティのベストプラクティス適用

- **データベース更新**
  - サンプルデータベース（URS/sample-eparts.db）を最新の本番データで更新

### 📊 統計情報（更新）

- **総コード行数**: 2,959行（TypeScript/React）
- **プロジェクト全体**: 8,598行（設定・ドキュメント含む）
- **コンポーネント数**: 7個（React TSX）
- **対応ブラウザ**: Chrome, Safari, Firefox, Edge

## [2.0.1] - 2025-07-18

### 🐛 修正

- **検索機能のUIバグ修正**
  - 検索タブ切り替え時のUIバグを修正（Issue #2）
  - タブ切り替え時の検索結果表示が適切に更新されるよう改善

### 🧹 コード整理

- **不要ファイルの削除**
  - 使用されていない`validation.ts`ファイルをGit管理から除外（Issue #3）
  - コードベースのクリーンアップとメンテナンス性向上

### 📊 統計情報（更新）

- **総コード行数**: 2,921行（TypeScript/React）
- **プロジェクト全体**: 8,631行（設定・ドキュメント含む）
- **コンポーネント数**: 7個（React TSX）
- **対応ブラウザ**: Chrome, Safari, Firefox, Edge

## [2.0.0] - 2025-06-30

### 💥 破壊的変更

- **データベーススキーマの変更**
  - inventoryテーブルに`shop_url`フィールドを追加
  - フィールド順序の変更: `shop, price_per_unit, currency, memo, shop_url`
  - 既存データベースとの互換性なし（マイグレーションが必要）

### ✨ 新機能

- **購入先URL（shop_url）フィールドの追加**
  - パーツ詳細表示: 購入先URLをクリック可能なリンクとして表示
  - パーツ追加・編集フォーム: 購入先URLの入力フィールドを追加
  - データベーススキーマ: inventoryテーブルにshop_urlカラムを追加

### 🔧 改善

- **ユーザビリティの向上**
  - README.mdの使い方セクションを論理的に再構成
  - 初期セットアップの必要性を明確化
  - リモート・ローカルモードの説明を一貫性のある構成に変更

- **パフォーマンス最適化**
  - 特定パーツ取得用の`getPartById()`メソッドを追加
  - パーツ編集後の状態更新を全データ取得から単一パーツ取得に最適化

- **コード品質向上**
  - デバッグ用console.logの削除
  - 使用されていない配列の削除とインライン化
  - データベースフィールド順序の統一

### 📊 統計情報（更新）

- **総コード行数**: 2,930行（TypeScript/React）
- **プロジェクト全体**: 8,743行（設定・ドキュメント含む）
- **コンポーネント数**: 9個（React TSX）
- **対応ブラウザ**: Chrome, Safari, Firefox, Edge

### 📚 ドキュメント更新

- **README.mdの大幅改善**
  - 使い方セクションの論理的再構成
  - 初期セットアップの重要性を強調
  - リモート・ローカルモードの説明を一貫化

### 🚨 アップグレード注意事項

- **既存ユーザー向け**: データベーススキーマが変更されているため、既存のeparts.dbファイルは新しいバージョンと互換性がありません
- **移行方法**: 新しいスキーマに基づく空のデータベースからデータを再入力するか、カスタムマイグレーションスクリプトの使用が必要です

## [1.1.1] - 2025-06-28

### 🔧 改善

- **レスポンシブUI/UX**
  - スマートフォン対応: メインタイトルをh2に変更して1行表示を改善
  - パーツ詳細ダイアログ: カテゴリ表示形式を「カテゴリ名(ID)」に統一
  - カテゴリ編集ダイアログ: ID表示を削除してUIをシンプル化

- **モーダルダイアログの統一化**
  - パーツ追加/編集ダイアログ: フィールド表示順序を統一
  - タイプの後の順序: 説明 → データシートURL(1行表示) → 単価/通貨/購入情報
  - データシートURLフィールドを1行表示に変更

### 🐛 修正

- スマートフォンでのタイトル表示問題を解決
- モーダルダイアログのレイアウト一貫性を改善

## [1.1.0] - 2025-06-22

### ✨ 新機能

- **カテゴリ管理機能の大幅強化**
  - カテゴリの新規追加機能
  - カテゴリの削除機能（関連パーツ・在庫の自動削除）
  - モーダルダイアログ内での一括編集
  - 変更の一括保存（トランザクション対応）

### 🔧 改善

- **カテゴリ編集UI/UX**
  - 新規カテゴリ追加用の専用入力フォーム
  - 削除ボタン（ゴミ箱アイコン）の追加
  - 新規追加カテゴリの視覚的区別（緑色のハイライト）
  - キャンセル時の適切な状態リセット

- **データベース処理**
  - カスケード削除の実装（カテゴリ削除時の関連データ自動削除）
  - サンプルデータモードでの削除機能対応
  - 新規カテゴリの一時ID管理（負の値を使用）
  - トランザクション処理による安全な更新

- **コード品質**
  - TypeScript型安全性の向上
  - エラーハンドリングの強化
  - デバッグログの追加

### 📊 統計情報（更新）

- **総コード行数**: 2,730行（TypeScript/React）
- **プロジェクト全体**: 8,384行（設定・ドキュメント含む）
- **コンポーネント数**: 9個（React TSX）
- **対応ブラウザ**: Chrome, Safari, Firefox, Edge

### 🚀 技術的改善

- **データベース管理**
  - `updateCategories`関数の機能拡張
  - 削除対象カテゴリIDの管理機能
  - 一時IDから正式IDへの自動変換

- **UI コンポーネント**
  - `CategoryEditModal`の大幅リファクタリング
  - 状態管理の最適化
  - ユーザビリティの向上

### 🐛 修正

- カテゴリ追加時のデータベース反映問題を解決
- カテゴリ削除時の関連データ処理を修正
- モーダルキャンセル時の状態管理を改善

### 📚 ドキュメント更新

- README.mdの機能説明を更新
- カテゴリ管理機能の詳細説明を追加
- プロジェクト統計の最新化

## [1.0.0] - 2025-06-19

### ✨ 追加

- **電子パーツ在庫管理システム** - React + TypeScript + Vite + sql.js による SPA
- **パーツ検索機能** - カテゴリ別検索とキーワード検索
- **在庫管理機能** - パーツの在庫数表示・編集
- **パーツ編集機能** - パーツ情報の編集・更新
- **パーツ追加機能** - 新規パーツの追加
- **パーツ削除機能** - 不要なパーツの削除
- **データ同期機能** - データベースファイルのダウンロード
- **環境自動判別** - ローカル/リモートモードの自動切り替え
- **レスポンシブUI** - スマートフォン・タブレット対応
- **デュアルブランチ運用** - main（開発）/gh-pages（デプロイ）ブランチ戦略
- **データベース自動保護** - .gitattributes による個人データの自動保護
- **GitHub Actions** - 自動ビルド・デプロイパイプライン
- **ブラウザ別ダウンロード対応** - Chrome/Safari/Firefox 対応
- **sql.js統合** - ブラウザ内SQLiteデータベース

### 🛠️ 技術仕様

- **フロントエンド**: React 18 + TypeScript + Vite
- **データベース**: SQLite + sql.js（ブラウザ内実行）
- **スタイリング**: Tailwind CSS
- **アイコン**: Lucide React
- **ホスティング**: GitHub Pages（静的）
- **ビルドツール**: Vite
- **型安全性**: TypeScript strict mode

### 📊 統計情報

- **総コード行数**: 2,277行（TypeScript/React）
- **プロジェクト全体**: 7,271行（設定・ドキュメント含む）
- **コンポーネント数**: 6個（React TSX）
- **対応ブラウザ**: Chrome, Safari, Firefox, Edge

### 🎯 運用モード

- **ローカルモード**: 編集・追加・削除が可能、データ管理用
- **リモートモード**: 読み取り専用、データ閲覧用（GitHub Pages）

### 🔒 セキュリティ・品質

- **型安全性**: TypeScript による静的型チェック
- **エラーハンドリング**: 包括的なエラー処理
- **データ保護**: Git マージ時の個人データ自動保護
- **コード品質**: ESLint による品質管理

### 📚 ドキュメント

- **包括的なREADME**: セットアップから運用まで詳細説明
- **ブランチ戦略文書**: デュアルブランチ運用の詳細
- **トラブルシューティング**: よくある問題と解決方法
- **データベーススキーマ**: 詳細なDB設計文書

### 🎉 特記事項

このバージョンは、電子パーツ在庫管理システムの初回安定リリースです。
個人利用から小規模チーム利用まで対応し、GitHub Pages での簡単なデプロイが可能です。

---

## リリース履歴

- **[2.0.0]** - 2025-06-30: メジャーアップデート - 購入先URLフィールド追加とDBスキーマ変更
- **[1.1.1]** - 2025-06-28: UI/UX改善とレスポンシブ対応強化
- **[1.1.0]** - 2025-06-22: カテゴリ管理機能の大幅強化（追加・削除対応）
- **[1.0.0]** - 2025-06-19: 初回安定リリース - 全基本機能実装完了
